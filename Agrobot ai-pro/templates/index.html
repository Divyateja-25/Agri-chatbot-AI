{% extends "base.html" %}
{% block content %}
<div class="container">

  <aside class="sidebar card">
    <h3>{{ _('Your profile') }}</h3>
    {% if current_user.is_authenticated %}
      <p><strong>{{ current_user.name or current_user.email }}</strong></p>
      <p>{{ _('Crop:') }} {{ current_user.primary_crop or "â€”" }}</p>
      <p>{{ _('Region:') }} {{ current_user.region or "â€”" }}</p>
      <p>{{ _('Lang:') }} {{ current_user.preferred_language or "en" }}</p>
      <a class="btn" href="{{ url_for('profile') }}">{{ _('Edit profile') }}</a>
    {% else %}
      <p>
        <a href="{{ url_for('login') }}">{{ _('Login') }}</a> 
        {{ _('to save chat & see profile.') }}
      </p>
    {% endif %}
    
    {% if recent_users %}
      <hr>
      <h4>{{ _('Recent users (admin)') }}</h4>
      <ul class="user-list">
        {% for u in recent_users %}
          <li><a href="{{ url_for('admin_view_user', user_id=u.id) }}">{{ u.email }} - {{ u.name or 'â€”' }}</a></li>
        {% endfor %}
      </ul>
    {% endif %}
  </aside>

  <section class="chat-panel card">
    <div id="messages" class="messages" aria-live="polite">
        </div>

    <div class="suggestion-chips">
        <button class="chip">{{ _('Best soil for corn') }}</button>
        <button class="chip">{{ _('Common pests in Vijayawada') }}</button>
        <button class="chip">{{ _('Watering schedule') }}</button>
    </div>
    
    <form id="chatForm" class="chat-form" onsubmit="return false;">
        <input id="msg" aria-label="{{ _('Type your question') }}" placeholder="{{ _("Ask about crops, pests or soil (e.g. 'best soil for cotton')") }}" autocomplete="off">

        <label for="imageInput" class="btn" style="cursor: pointer;" title="{{ _('Upload Image for Analysis') }}">
            {{ _('ðŸ“· Image') }}
        </label>
        <input type="file" id="imageInput" accept="image/*" style="display: none;">

        <button id="voiceBtn" type="button" class="btn" title="{{ _('Voice Input') }}">{{ _('ðŸŽ¤ Voice') }}</button>

        <button id="sendBtn" type="button" class="btn">{{ _('Send') }}</button>
    </form>
</section>
</div>
{% endblock %}